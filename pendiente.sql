
-- WITH EmpleadosConCategoria AS (
--     SELECT
--         P.BusinessEntityID, -- ID del empleado
--         DATEDIFF(YEAR, P.BirthDate, '2025-12-31') AS Edad, -- ğŸ‚ Edad calculada
--         CASE
--             WHEN DATEDIFF(YEAR, P.BirthDate, '2025-12-31') BETWEEN 25 AND 40 THEN 'Junior' -- ğŸ‘¶ Junior
--             WHEN DATEDIFF(YEAR, P.BirthDate, '2025-12-31') BETWEEN 41 AND 55 THEN 'Senior' -- ğŸ§‘â€ğŸ¦³ Senior
--             WHEN DATEDIFF(YEAR, P.BirthDate, '2025-12-31') BETWEEN 56 AND 75 THEN 'MÃ©rito' -- ğŸ‘‘ MÃ©rito
--             ELSE 'Otra CategorÃ­a' -- â“ Para edades fuera de los rangos definidos
--         END AS Categoria -- ğŸ·ï¸ La categorÃ­a del empleado
--     FROM
--         Person.Person P, -- Alias 'P'
--         HumanResources.Employee E -- Alias 'E'
--     WHERE
--         P.BusinessEntityID = E.BusinessEntityID -- ğŸ¤ CondiciÃ³n de uniÃ³n
--         AND P.BirthDate IS NOT NULL -- ğŸ“… Aseguramos que tengan fecha de nacimiento
--         AND DATEDIFF(YEAR, P.BirthDate, '2025-12-31') BETWEEN 25 AND 75 -- ğŸ¯ Filtramos por edades dentro de los rangos de interÃ©s
-- )
-- SELECT
--     Categoria, -- ğŸ·ï¸ La categorÃ­a
--     COUNT(BusinessEntityID) AS Cantidad -- ğŸ“Š Cantidad de empleados en esa categorÃ­a
-- FROM
--     EmpleadosConCategoria -- Usamos la CTE como si fuera una tabla
-- GROUP BY
--     Categoria -- ğŸ”¢ Agrupamos directamente por la columna 'Categoria' ya calculada
-- ORDER BY
--     -- Ordenamos las categorÃ­as para que aparezcan en el orden lÃ³gico: Junior, Senior, MÃ©rito
--     CASE
--         WHEN Categoria = 'Junior' THEN 1
--         WHEN Categoria = 'Senior' THEN 2
--         WHEN Categoria = 'MÃ©rito' THEN 3
--         ELSE 4
--     END;
